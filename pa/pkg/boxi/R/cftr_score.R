list4.1=c("621+1G>T", "3500-2A>G","G542X", "1717-1G>A", "R553X", "W1282X", "711+1G>T","711+1G->T", "1898+1G>A", "1154insTC", "2184insA",
          "S489X","3659delC", "Q493X", "E60X", "R1162X", "Y1092X", "2183AA->G", "3905insT", "394delTT", "2184delA", "4016insT",
          "Q1313X", "E585X", "2183AA>G", "2347delG", "3007delG", "R1158X", "1078delT", "CFTRdele2,3", "S4X", "2622+1G>A","2622+1G->A",
          "3120+1G>A", "E831X", "R75X", "W846X", "1161delC", "1213delT", "1248+1G>A", "1259insA", "2143delT", "2189CT->A",
          "2622+1G>T", "2787del16bps", "365-366insT", "406-1G>A", "4209TGTT>AA", "557delT", "712-1G->T", "CFTRdele2-3",
          "CFTRdele2-4", "E193X", "K710X", "L1254X", "L732X", "Q220X", "Q39X", "Q414X", "Q814X", "S1196X", "S912X", "1138insG",
          "1249-27delTA", "1249-29delAT", "1309delG", "1342-1delG", "185+1G>T", "2002del8(GCTATTTT)", "2118del4", "2184DELA",
          "3028delA", "3271+1G>T", "3396delC", "3447delG", "3617delGA", "3659DELC", "3662delA", "3667ins4(TCAA)", "4089delA",
          "4326delTC", "4374+1G>T", "441delA", "C524X", "CFTRdele10", "CFTRdele2", "CFTRdele4-8", "E1104X", "G27X", "K553X",
          "Q1382X", "Q890X", "R709X", "R785X", "S466X(TAG)", "W1274X", "Y1092X1001+11CORdelTAF508", "3120G>A", "3876delA", "457TATdelinsG",
          "875+1G>C", "C276X", "CFTRdele17A-18", "L88X(T>G)", "del exons 2-3", "del exon 2-3",
          "681delC", "c.4021dupT", "(p.PHE342fs)", "L218X", "474del13BP,490C>G,491G->",
          "1288INTA", "1288insTA", "1366delG", "1461insAGAT", "1524+1G>A", "1811+1G>C", "1874insT", "2105-2117 del13insAGAAA",
          "2142delT", "2183delT", "2951insA", "296+1G>T", "306insA", "3154delG", "3171insC", "360-365insT", "3600+1G>T",
          "360insT", "3791delC", "4010del4(TATT)", "4022insT", "4374+1G>A", "650delATAAA", "G330X", "K793X", "Q1035X",
          "Q1313X and I1027T","delF508;I1027T"  , "Q552X", "W1089X", "W679X", "Y1307X", "Y849X", "W1282X", "G542X",
          "R553X","E60X", "2184insA", "712-1G->T", "2183AA-G", "621+1G->T", "1154insTC", "1461ins4", "1898+1G->A",
          "2183delAA>G", "3120+1G->A", "3349insT", "1154InsTC", "ex14a",  "E92X", "Dup ex6b-10",
          "654del5", "237insA", "W1204X", "Y122X", "CFTRdele2(ins186)", "1717-1G->A", "R851X", "406-1G->A", "Q2X", "2585delT", "del X22-24",
          "del exon 14b-17b","c.1021_1022dupTC","Del exon 19-21","c.3874-1G>A","c.1021_1022dup(p.Phe342fs",
          "2185inC","L88X(T>A)","M1T","CFTRdup7-11","c.4021dupT(p.Ser1297fs)","2184insG","CFTRdele11","Y275X","CFTRdup6b-10")

list4.2=c("621+1G>T", "W1282X", "G542X", "1717-1G>A", "3659delC", "R553X", "2184delA", "1154insTC", "711+1G>T",
          "R1158X", "R1162X", "R75X", "W57X", "Y1092X", "1898+1G>A", "2183AA>G", "2184DELA", "3905insT", "CFTRdele10",
          "CFTRdele2,3", "E585X", "E60X", "S489X", "S4X",  "11531154dup",
          "1461ins4(AGAT)", "1716-1G>A", "3120+1G>T", "4016insT", "4016onsT", "L218X", "Q1042X", "Q552X", "R709X", "W1204X",
          "1138insG", "1161delC", "1525-1G>A", "2622+1G>A", "3171delC",
          "3786delA", "712-1G>T", "CFTRdele2-3", "Q493X",  "621+1G->T", "W1089X", "712-1G->T",  "1717-1G->A" ,"Q1412X","R792X")

list3.1=c("DF508", "[delta]F508", "delF508", "[delta]I507", "[delta]F508/I507", "[delta]F508;I1027T", "F", "F(_I507)", "I507", "_I507",
          "F508del", "F508", "I507","delF508/I507")

list3.2=c("DF508", "[delta]F508", "delF508", "[delta]I507", "delI507","F", "I507",
          "S1251N(F508C)", "F(_I507)","F508del", "F508", "DI507","I507del")


list2.1=c("M1101K", "N1303K", "V520F", "R1066C","L1077P", "R560T", "S549N", "A561E" )

list2.2=c("G551D", "N1303K", "M1101K", "R560T", "L1077P", "V520F", "S549N", "R1066C;IVS8(5T)", "IVS8 5T", "I148T;3199del6",
          "3199del6", "R1066C","I148T I148T/3199del6")

list1.1=c("A455E", "2789+5G>A","G970D", "L1335P", "L145H", "R347P", "S341P", "1716G>A", "G1244E", "G85E", "L206W", "R117H",
          "Y503N","(3499+37G>A)", "1868A>G", "3849+10kbC>T", "7T", "D1152H", "G239R",
          "G480S", "M1137V", "R117H(5T)", "R31L", "R334L", "R334W", "R347H", "V392G", "Y569D",
          "-743delT","4005+2T>C", "A155P", "D579G", "F508I (c.1663T>A)", "G458V", "G576A", "I148T", "I506T", "IVS8(5T)",
          "L138ins", "L558S", "L997F", "P67L", "R555G", "S492F", "W1098R", "Y109C","Y563N"  )
list1.2=c("G85E", "3849+10kbC>T", "3849+10kbC->T" ,"A455E", "IVS8(5T)", "3272-26A>G", "3600+2insT", "I1027T", "S1251N",
          "S1251N", "2789+5G>A", "G1247R", "I148T", "P574H", "R347P", "2789+2insA", "3121-2A>G", "3600G>A", "4005+2T>C",
          "711+5G>A", "A1006E+V562I_in_cis", "G1244E", "H1079P", "L206W", "P67L", "Q1291H", "Q1411X", "R1070Q", "S341P",
          "S492F","1525-2A>G", "2752-2A>G", "3273-26A>G", "3850-3T>G;R75Q", "A559T", "D1152H", "D579G", "H199R", "I1234V",
          "I336K", "I444S", "I506T","L468P", "L558S", "Q1071K", "R1070W", "R117H", "R117H with 7T","R334W", "R75Q", "S1118C",
          "S954L", "V1240G; R75Q", "V562I; IVS8(5T)","1868A>G", "2789+5G>A", "3272-93", "L206W;R668C",
          "3849+10kbc>T", "5T", "7T", "A1076V", "A455E", "A559T", "D110H", "D1152H", "G85E", "L206W", "P67L", "Q1291H", "R117H",
          "R334W", "R352Q", "Y569D", "t1299i", "1898+3G>A", "711+3A>G", "A1067V", "C332T", "D614G", "G178R", "G628R(5T)", "L1335P",
          "N396Y", "R1117H", "R117C", "R117H(5T)", "R347H", "R347P/R347H", "S1235R", "S549R", "T1299I", "T338I", "V1153E", "V232D",
          "V456A", "W1098R", "Y914C","-589G>A", "1002-2A>G", "2789+5C>T", "2789+5G>A;I102(7T)",
          "3849+10kbC>T; R668C", "3849G>A", "546insCTA", "621+2G>T", "875+40A>G", "A1006E+V562IINCIS", "A613T", "D1270N; R74W",
          "D443Y", "E116K", "F508C", "G1003E", "G458V", "L165S", "M150K", "R117H(7T)", "R117P", "R560K", "R668C", "S1159F",
          "Q1209P", "2789+5G->A", "D1270N" )

m1=c("NEGATIVE", "MISSINGDATA", "WAITINGRESU"," ", "________", "c.4028C>T", "NOTTYPED", "UNKNOWN", "-999","unknown" ,"Not ID", "UNK",
     "**No Data Available","Missing","**Not Identified","unk","Unknown")


#' Assigning CFTR score based on CFTR mutations
#' @param allele1
#' @param allele2
#'
#' @return CFTR scores
cftr <- function(allele1, allele2) {
  n = length(allele1)
  score <- rep(0, n)
  # assign allele score
  allele_score <- function(al){
    ifelse(al %in% c(list4.1, list4.2), 4,
    ifelse(al %in% c(list3.1, list3.2), 3,
    ifelse(al %in% c(list2.1, list2.2), 2,
    ifelse(al %in% c(list1.1, list1.2), 1, 0))))
    }
  # combining 2 allele scores into CFTR score
  combine_score <- function(s1, s2){
    score <- rep(0, n)
    # CFTR 5: s1 = s2 = 4;
    score[(s1==4) & (s2==4)] <- 5
    # CFTR 4: {s1,s2} = {3,4};
    score[(s1+s2)==7] <- 4
    # CFTR 3: s1 = s2 = 3;
    score[((s1==3) & (s2==3))] <- 3
    # CFTR 2: The minimum score of the two alleles is 2
    score[((s1==2) | (s2==2)) & ((s1+s2)>=4)] <- 2
    # CFTR 2: The minimum score of the two alleles is 1
    score[((s1==1) | (s2==1)) & ((s1+s2)>=2)] <- 1
    return(score)
  }
  return(combine_score(allele_score(allele1),
                       allele_score(allele2)))
}



### The following is Jerry's original code for cftr assignment. ######
#
# assign_cftr <- function(input_data){
#   output <- array(dim=length(input_data))
#   for(i in 1:length(input_data)){
#     if(input_data[i] %in% c(list4.1, list4.2)){
#       output[i] <- 4
#     }
#     else if(input_data[i] %in% c(list3.1, list3.2)){
#       output[i] <- 3
#     }
#     else if(input_data[i] %in% c(list2.1, list2.2)){
#       output[i] <- 2
#     }
#     else if(input_data[i] %in% c(list1.1, list1.2)){
#       output[i] <- 1
#     }
#     else if(input_data[i] %in% m1){
#       output[i] <- 0
#     }
#   }
#   output
# }
#
# nn5=which(adam$CFTR_score1%in%'4' & adam$CFTR_score2%in%'4')
# nn4=which((adam$CFTR_score1%in%'3' & adam$CFTR_score2%in%'4') | (adam$CFTR_score1%in%'4' & adam$CFTR_score2%in%'3'))
# nn3=which(adam$CFTR_score1%in%'3' & adam$CFTR_score2%in%'3')
# nn2=which((adam$CFTR_score1%in%'2' & adam$CFTR_score2>=2)|(adam$CFTR_score1>=2& adam$CFTR_score2%in%'2'))
# nn1=which((adam$CFTR_score1%in%'1' & adam$CFTR_score2>=1)|(adam$CFTR_score1>=1& adam$CFTR_score2%in%'1'))
# nn0=which(adam$CFTR_score1%in%'0' | adam$CFTR_score2%in%'0')
#
#
# adam$CFTR_score[nn5]=5
# adam$CFTR_score[nn4]=4
#
# adam$CFTR_score[nn3]=3
# adam$CFTR_score[nn2]=2
# adam$CFTR_score[nn1]=1
# adam$CFTR_score[nn0]=0
#
#
#
#
# #================Old CFTR Assign function=======================#
#
# assign_cftr <- function(input_data){
#   output <- array(dim=length(input_data))
#     for(i in 1:length(input_data)){
#       if(input_data[i] %in% c(list4.1, list4.2)){
#         output[i] <- 4
#       }
#       else if(input_data[i] %in% c(list3.1, list3.2)){
#         output[i] <- 3
#       }
#       else if(input_data[i] %in% c(list2.1, list2.2)){
#         output[i] <- 2
#       }
#       else if(input_data[i] %in% c(list1.1, list1.2)){
#         output[i] <- 1
#       }
#       else if(input_data[i] %in% m1){
#         output[i] <- 0
#       }
#     }
#
#   output
# }
